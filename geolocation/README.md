## Сервис геопозиционирования
Сервис, в котором вы можете отслеживать координаты ваших устройств тогда, когда вам это необходимо
### Задача
Предоставить координаты расположения устройств с нужной вам частотой обновления

## Целевая аудитория
```markdown
Пользователи мужского и женского пола старше 20 - 60 лет
Согласно https://bdex.ru/naselenie/russia/ приблизительно 75 млн человек
Место пребывания - города на территории Российской Федерации с населением более 1 000 000 человек
Пользователь заинтересуется приложением в связи с доступным к бесплатному использованию базовыми функциями
Доход - для привлечения базовым функционалом не важен, для использования дополнительного функционала - в среднем более 50 000 рублей
```

В рамках MVP пользователю доступно зарегистрировать до трех устройств
Устройствам доступна возможность отправлять текущие координаты на сервер
Пользователю доступен функционал выставлять периодичность отправки

Описание предметной области заказчиком
1 Пользователь регистрируется в системе геолокации
2 Пользователь подтверждает регистрацию
2 Пользователь авторизуется в системе
3 Пользователь регистрирует в системе устройство для сохранения гео данных
4 Пользователь настраивает периодичность отправки данных на стороне устройства
5 Устройство пользователя отправляет координаты в систему геолокации
6 Пользователь хочет посмотреть текущее расположение в реальном времени
7 Пользователь хочет посмотреть путь за период

## Описание MVP
Устройство пользователя отправляет координаты в систему геолокации
Пользователь хочет посмотреть текущее расположение в реальном времени
Пользователь хочет посмотреть все события по устройству
Пользователь хочет посмотреть путь за период

Сущность:
Location
Параметры устройства в определенный момент времени

| Название параметра | Описание                   | Тип поля  | Обязательность | Ограничения |
|--------------------|----------------------------|-----------|----------------|-------------|
| deviceId           | Идентификатор устройства   | Long      | Да             |             |
| ownerId            | Идентификатор пользователя | Long      | Да             |             |
| longitude          | Долгота                    | Double    | Да             |             |
| latitude           | Широта                     | Double    | Да             |             |
| bearing            | Азимут                     | Double    | Нет            |             |
| speed              | Cкорость передвижения      | Double    | Нет            |             |            
| altitude           | Высота                     | Double    | Нет            |             |
| dateDime           | Дата и время события       | Timestamp | Да             |             |
| bataryLevel        | Уровень батареи            | Float     | Нет            |             |

### Сохранение текущих параметров:
POST api/v1/location параметры сущности Location

В случае успеха:
Http status: 201

В случае не успеха с ошибкой со стороны клиента:
Http status: 400
Структура сообщения ответа

| Название параметра | Описание           | Тип поля | Обязательность | Ограничения |
|--------------------|--------------------|----------|----------------|-------------|
| errCode            | Код бизнес ошибки  | Int      | Да             |             |
| errDescription     | Описание ошибки    | String   | Да             |             |
| errSystemText      | Системное описание | String   | Да             |             |

В случае не успеха с ошибкой со стороны сервера:
Http status: 500
Структура сообщения ответа

| Название параметра | Описание           | Тип поля | Обязательность | Ограничения |
|--------------------|--------------------|----------|----------------|-------------|
| errCode            | Код бизнес ошибки  | Int      | Да             |             |
| errDescription     | Описание ошибки    | String   | Да             |             |
| errSystemText      | Системное описание | String   | Да             |             |

### Получение текущих координат по идентификатору устройства:
GET api/v1/localtion/current/{deviceId}

В случае успеха:
Http code 200
Payload
Вернется сущность Location

В случае не успеха: аналогично предыдущим ошибкам

### Получение существующих событий по идентификатору устройства:
GET api/v1/localtion/all/{deviceId}

В случае успеха:
Http code 200
Payload
Список сущностей Location

В случае не успеха: аналогично предыдущим ошибкам

### Получение событий за период по идентификатору устройства:
GET api/v1/localtion/{deviceId}?dateFrom={dateFrom}&dateTo={dateTo}
dateFrom - дата начала периода
dateTo - дата окончания периода

В случае успеха:
Http code 200
Payload
Список сущностей Location

В случае не успеха: аналогично предыдущим ошибкам


### Удаление события по устройству
DELETE api/v1/location/{deviceId}
Payload
id - идентификатор события


### User Story

```markdown
User Story 1: Отправка координат
Как Авторизованный пользователь
Я хочу, чтобы при отправке параметров устройством координаты сохранялись в сервисе

Критерии приемки:

При отправке координат клиентом данные сохраняются в бд
```

```markdown
User Story 2: Просмотр текущего местоположения
Как авторизованный пользователь
Я хочу видеть текущее местоположение устройства на карте

Критерии приемки:
Пользователь авторизован, устройство зарегистрировано
При нажатии кнопки "Показать местоположение" на карте отображаются координаты
```

```markdown
User Story 3: Просмотр истории перемещений за период
Как авторизованный пользователь
Я хочу просматривать историю перемещений за выбранный период

Критерии приемки:
Пользователь вводит даты начала и конца периода
При нажатии "Отобразить" система показывает карту с треком перемещений
Трек отображается в виде линии/точек, соответствующих сохраненным координатам
```

Прилагаю диаграмму приложения в виде C4 диаграммы
[C4 diagram.drawio](C4%20diagram.drawio)

### Команды сборки проекта
```shell
docker build -f Dockerfile -t geolocation:0.0.1 .
```

```shell
docker tag geolocation:0.0.1 alyanovao/geolocation:0.0.1
```

```shell
docker push alyanovao/geolocation:0.0.1
```

```shell
docker login
```

```shell
docker-compose -p geolocation -f ../docker/docker-compose.yaml up -d
```


# Запуск Postgres
```shell
docker-compose -p postgress -f ../docker/docker-compose-db.yaml up -d
```